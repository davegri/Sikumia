<!DOCTYPE html>
<html dir="rtl">
    {% load staticfiles %}
    <head>
        <title>sikumim</title>
        <link href='http://fonts.googleapis.com/css?family=Alef:400,700&subset=latin,hebrew' rel='stylesheet' type='text/css'>
        <LINK href="{% static "css/base.css" %}" rel="stylesheet" type="text/css">
        <script src="{% static "js/jquery.js" %}"></script>
        <script>


function ColorLuminance(hex, lum) {
    // validate hex string
    hex = String(hex).replace(/[^0-9a-f]/gi, '');
    if (hex.length < 6) {
        hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
    }
    lum = lum || 0;
    // convert to decimal and change luminosity
    var rgb = "#", c, i;
    for (i = 0; i < 3; i++) {
        c = parseInt(hex.substr(i*2,2), 16);
        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);
        rgb += ("00"+c).substr(c.length);
    }
    return rgb;
}

    function hexc(colorval) {
    var parts = colorval.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
    delete(parts[0]);
    for (var i = 1; i <= 3; ++i) {
        parts[i] = parseInt(parts[i]).toString(16);
        if (parts[i].length == 1) parts[i] = '0' + parts[i];
    }
    color = '#' + parts.join('');

    return color;
}
        $(document).ready(function () {
            $('.nav-button').each(function(index){
                var color = $(this).css('background-color');
                var hexcolor = hexc(color);
                var newcolor = ColorLuminance(hexcolor,-0.2);
                $(this).css('box-shadow','0px 5px 0px 0px '+newcolor+' ');
            });
        });
        </script>
        <style>
        .nav-button:active{
        transform: translate(0px, 5px)!important;
        -webkit-transform: translate(0px, 5px)!important;
        box-shadow: 0px 0px 0px 0px!important;
        }
        </style>
        {% block head %}{% endblock %}
        <LINK href="{% static "css/responsive.css" %}" rel="stylesheet" type="text/css">
        <meta charset="UTF-8">
    </head>
    <body>
    <div class="page-wrap">
        <div class="header-container">
            <header>
                <a href="{% url 'index' %}" class="logo_wrapper"><h1>סיכומים.נט</h1></a>
                <div class="panel-wrapper">
                    <div class="panel">
                        {% if user.is_authenticated %}
                            <form id='logout_form' method="post" action="{% url 'logout' %}">
                                {% csrf_token %}
                                <h4 class="welcome_message">ברוך הבא <strong>{{ user.username }}</strong></h4>
                                <input type="submit" id="logout" name="logout" value="התנתק">
                                <a href='' class="button">פרופיל</a>
                                {% if user.is_staff %}<a href='/admin' class="button">פאנל ניהול</a>{% endif %}
                                
                            </form>
                        {% else %}
                            <form id="login_form" method="post" action='{% url 'login' %}'>
                                {% csrf_token %}
                                <h4>התחברות משתמשים רשומים</h4>
                                <input type="text" id="login_username" name="login_username" placeholder="משתמש">
                                <input type="password" id="login_password" name="login_password" placeholder="סיסמא">
                                <input type="submit" id="login_submit" name="login_submit" value="התחבר">
                                {% if messages %}
                                    {% for message in messages %}
                                        <div class='login_error'>{{ message }}</div>
                                    {% endfor %}
                                {% endif %}
                                <div class="lock"></div>
                            </form>
                        {% endif %}
                    </div>
                </div>
            </header>
        </div>
        <div class="container">
            <form id="search_form" method="get" action="{% url 'search' %}">
                <div class="row">
                        {% if user.is_authenticated %}
                    <a class="call-to-action col-6" href="{% url 'upload' %}">
                        הוספת סיכום לאתר
                    </a>
                                        <div class="search-box col-10">
                        {{ search_form.query }}
                        <input type="submit" value="חפש">
                    </div>

        {% else %}

                                <a class="call-to-action col-4" href="{% url 'register' %}">
                        הרשם עכשיו <strong>בחינם</strong>
                    </a>

                            <a class="call-to-action col-6" href="{% url 'upload' %}">
                        התחבר באמצעות פייסבוק
                    </a>
                                        <div class="search-box col-6">
                        {{ search_form.query }}
                        <input type="submit" value="חפש">
                    </div>
        {% endif %}

                </div>
                <div class="row">
                    <nav class="col-16">
                        <ol class="row">
                            {% for subject in subjects  %}
                                <a href="{% url 'subject' subject.name%}" class='col-2'>
                                    <li style="background-color: #{{subject.color}}" class="nav-button">{{ subject.hebrew_name }}</li>
                                </a>
                            {% endfor %}
                        </ol>
                    </nav>
                </div>
            </form>
            {% block body %}{% endblock %}
    </div>
    </div>
    <footer><span>2013 © כל הזכויות שמורות לסיכומים.נט</span></footer>
</body>
</html>